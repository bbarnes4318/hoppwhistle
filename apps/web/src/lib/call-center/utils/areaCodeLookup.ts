// areaCodeLookup.ts
// Utility to derive state from phone number area code

// Comprehensive US Area Code to State mapping
const AREA_CODE_TO_STATE: Record<string, string> = {
  // Alabama
  '205': 'Alabama',
  '251': 'Alabama',
  '256': 'Alabama',
  '334': 'Alabama',
  '938': 'Alabama',
  // Alaska
  '907': 'Alaska',
  // Arizona
  '480': 'Arizona',
  '520': 'Arizona',
  '602': 'Arizona',
  '623': 'Arizona',
  '928': 'Arizona',
  // Arkansas
  '479': 'Arkansas',
  '501': 'Arkansas',
  '870': 'Arkansas',
  // California
  '209': 'California',
  '213': 'California',
  '279': 'California',
  '310': 'California',
  '323': 'California',
  '341': 'California',
  '408': 'California',
  '415': 'California',
  '424': 'California',
  '442': 'California',
  '510': 'California',
  '530': 'California',
  '559': 'California',
  '562': 'California',
  '619': 'California',
  '626': 'California',
  '628': 'California',
  '650': 'California',
  '657': 'California',
  '661': 'California',
  '669': 'California',
  '707': 'California',
  '714': 'California',
  '747': 'California',
  '760': 'California',
  '805': 'California',
  '818': 'California',
  '820': 'California',
  '831': 'California',
  '858': 'California',
  '909': 'California',
  '916': 'California',
  '925': 'California',
  '949': 'California',
  '951': 'California',
  // Colorado
  '303': 'Colorado',
  '719': 'Colorado',
  '720': 'Colorado',
  '970': 'Colorado',
  // Connecticut
  '203': 'Connecticut',
  '475': 'Connecticut',
  '860': 'Connecticut',
  '959': 'Connecticut',
  // Delaware
  '302': 'Delaware',
  // Florida
  '239': 'Florida',
  '305': 'Florida',
  '321': 'Florida',
  '352': 'Florida',
  '386': 'Florida',
  '407': 'Florida',
  '561': 'Florida',
  '727': 'Florida',
  '754': 'Florida',
  '772': 'Florida',
  '786': 'Florida',
  '813': 'Florida',
  '850': 'Florida',
  '863': 'Florida',
  '904': 'Florida',
  '941': 'Florida',
  '954': 'Florida',
  // Georgia
  '229': 'Georgia',
  '404': 'Georgia',
  '470': 'Georgia',
  '478': 'Georgia',
  '678': 'Georgia',
  '706': 'Georgia',
  '762': 'Georgia',
  '770': 'Georgia',
  '912': 'Georgia',
  '943': 'Georgia',
  // Hawaii
  '808': 'Hawaii',
  // Idaho
  '208': 'Idaho',
  '986': 'Idaho',
  // Illinois
  '217': 'Illinois',
  '224': 'Illinois',
  '309': 'Illinois',
  '312': 'Illinois',
  '331': 'Illinois',
  '618': 'Illinois',
  '630': 'Illinois',
  '708': 'Illinois',
  '773': 'Illinois',
  '779': 'Illinois',
  '815': 'Illinois',
  '847': 'Illinois',
  '872': 'Illinois',
  // Indiana
  '219': 'Indiana',
  '260': 'Indiana',
  '317': 'Indiana',
  '463': 'Indiana',
  '574': 'Indiana',
  '765': 'Indiana',
  '812': 'Indiana',
  '930': 'Indiana',
  // Iowa
  '319': 'Iowa',
  '515': 'Iowa',
  '563': 'Iowa',
  '641': 'Iowa',
  '712': 'Iowa',
  // Kansas
  '316': 'Kansas',
  '620': 'Kansas',
  '785': 'Kansas',
  '913': 'Kansas',
  // Kentucky
  '270': 'Kentucky',
  '364': 'Kentucky',
  '502': 'Kentucky',
  '606': 'Kentucky',
  '859': 'Kentucky',
  // Louisiana
  '225': 'Louisiana',
  '318': 'Louisiana',
  '337': 'Louisiana',
  '504': 'Louisiana',
  '985': 'Louisiana',
  // Maine
  '207': 'Maine',
  // Maryland
  '227': 'Maryland',
  '240': 'Maryland',
  '301': 'Maryland',
  '410': 'Maryland',
  '443': 'Maryland',
  '667': 'Maryland',
  // Massachusetts
  '339': 'Massachusetts',
  '351': 'Massachusetts',
  '413': 'Massachusetts',
  '508': 'Massachusetts',
  '617': 'Massachusetts',
  '774': 'Massachusetts',
  '781': 'Massachusetts',
  '857': 'Massachusetts',
  '978': 'Massachusetts',
  // Michigan
  '231': 'Michigan',
  '248': 'Michigan',
  '269': 'Michigan',
  '313': 'Michigan',
  '517': 'Michigan',
  '586': 'Michigan',
  '616': 'Michigan',
  '734': 'Michigan',
  '810': 'Michigan',
  '906': 'Michigan',
  '947': 'Michigan',
  '989': 'Michigan',
  // Minnesota
  '218': 'Minnesota',
  '320': 'Minnesota',
  '507': 'Minnesota',
  '612': 'Minnesota',
  '651': 'Minnesota',
  '763': 'Minnesota',
  '952': 'Minnesota',
  // Mississippi
  '228': 'Mississippi',
  '601': 'Mississippi',
  '662': 'Mississippi',
  '769': 'Mississippi',
  // Missouri
  '314': 'Missouri',
  '417': 'Missouri',
  '573': 'Missouri',
  '636': 'Missouri',
  '660': 'Missouri',
  '816': 'Missouri',
  // Montana
  '406': 'Montana',
  // Nebraska
  '308': 'Nebraska',
  '402': 'Nebraska',
  '531': 'Nebraska',
  // Nevada
  '702': 'Nevada',
  '725': 'Nevada',
  '775': 'Nevada',
  // New Hampshire
  '603': 'New Hampshire',
  // New Jersey
  '201': 'New Jersey',
  '551': 'New Jersey',
  '609': 'New Jersey',
  '732': 'New Jersey',
  '848': 'New Jersey',
  '856': 'New Jersey',
  '862': 'New Jersey',
  '908': 'New Jersey',
  '973': 'New Jersey',
  // New Mexico
  '505': 'New Mexico',
  '575': 'New Mexico',
  // New York
  '212': 'New York',
  '315': 'New York',
  '332': 'New York',
  '347': 'New York',
  '516': 'New York',
  '518': 'New York',
  '585': 'New York',
  '607': 'New York',
  '631': 'New York',
  '646': 'New York',
  '680': 'New York',
  '716': 'New York',
  '718': 'New York',
  '838': 'New York',
  '845': 'New York',
  '914': 'New York',
  '917': 'New York',
  '929': 'New York',
  '934': 'New York',
  // North Carolina
  '252': 'North Carolina',
  '336': 'North Carolina',
  '704': 'North Carolina',
  '743': 'North Carolina',
  '828': 'North Carolina',
  '910': 'North Carolina',
  '919': 'North Carolina',
  '980': 'North Carolina',
  '984': 'North Carolina',
  // North Dakota
  '701': 'North Dakota',
  // Ohio
  '216': 'Ohio',
  '220': 'Ohio',
  '234': 'Ohio',
  '283': 'Ohio',
  '330': 'Ohio',
  '380': 'Ohio',
  '419': 'Ohio',
  '440': 'Ohio',
  '513': 'Ohio',
  '567': 'Ohio',
  '614': 'Ohio',
  '740': 'Ohio',
  '937': 'Ohio',
  // Oklahoma
  '405': 'Oklahoma',
  '539': 'Oklahoma',
  '580': 'Oklahoma',
  '918': 'Oklahoma',
  // Oregon
  '458': 'Oregon',
  '503': 'Oregon',
  '541': 'Oregon',
  '971': 'Oregon',
  // Pennsylvania
  '215': 'Pennsylvania',
  '223': 'Pennsylvania',
  '267': 'Pennsylvania',
  '272': 'Pennsylvania',
  '412': 'Pennsylvania',
  '445': 'Pennsylvania',
  '484': 'Pennsylvania',
  '570': 'Pennsylvania',
  '582': 'Pennsylvania',
  '610': 'Pennsylvania',
  '717': 'Pennsylvania',
  '724': 'Pennsylvania',
  '814': 'Pennsylvania',
  '835': 'Pennsylvania',
  '878': 'Pennsylvania',
  // Rhode Island
  '401': 'Rhode Island',
  // South Carolina
  '803': 'South Carolina',
  '843': 'South Carolina',
  '854': 'South Carolina',
  '864': 'South Carolina',
  // South Dakota
  '605': 'South Dakota',
  // Tennessee
  '423': 'Tennessee',
  '615': 'Tennessee',
  '629': 'Tennessee',
  '731': 'Tennessee',
  '865': 'Tennessee',
  '901': 'Tennessee',
  '931': 'Tennessee',
  // Texas
  '210': 'Texas',
  '214': 'Texas',
  '254': 'Texas',
  '281': 'Texas',
  '325': 'Texas',
  '346': 'Texas',
  '361': 'Texas',
  '409': 'Texas',
  '430': 'Texas',
  '432': 'Texas',
  '469': 'Texas',
  '512': 'Texas',
  '682': 'Texas',
  '713': 'Texas',
  '726': 'Texas',
  '737': 'Texas',
  '806': 'Texas',
  '817': 'Texas',
  '830': 'Texas',
  '832': 'Texas',
  '903': 'Texas',
  '915': 'Texas',
  '936': 'Texas',
  '940': 'Texas',
  '956': 'Texas',
  '972': 'Texas',
  '979': 'Texas',
  // Utah
  '385': 'Utah',
  '435': 'Utah',
  '801': 'Utah',
  // Vermont
  '802': 'Vermont',
  // Virginia
  '276': 'Virginia',
  '434': 'Virginia',
  '540': 'Virginia',
  '571': 'Virginia',
  '703': 'Virginia',
  '757': 'Virginia',
  '804': 'Virginia',
  // Washington
  '206': 'Washington',
  '253': 'Washington',
  '360': 'Washington',
  '425': 'Washington',
  '509': 'Washington',
  '564': 'Washington',
  // West Virginia
  '304': 'West Virginia',
  '681': 'West Virginia',
  // Wisconsin
  '262': 'Wisconsin',
  '274': 'Wisconsin',
  '414': 'Wisconsin',
  '534': 'Wisconsin',
  '608': 'Wisconsin',
  '715': 'Wisconsin',
  '920': 'Wisconsin',
  // Wyoming
  '307': 'Wyoming',
  // Washington DC
  '202': 'Washington D.C.',
};

/**
 * Extract area code from a phone number
 */
export const extractAreaCode = (phoneNumber: string): string | null => {
  if (!phoneNumber) return null;

  // Remove all non-digit characters
  const digits = phoneNumber.replace(/\D/g, '');

  // Handle different formats
  if (digits.length === 10) {
    return digits.substring(0, 3);
  } else if (digits.length === 11 && digits.startsWith('1')) {
    return digits.substring(1, 4);
  }

  return null;
};

/**
 * Get state from phone number area code
 */
export const getStateFromAreaCode = (phoneNumber: string): string | null => {
  const areaCode = extractAreaCode(phoneNumber);
  if (!areaCode) return null;
  return AREA_CODE_TO_STATE[areaCode] || null;
};

/**
 * Get all area codes for a given state
 */
export const getAreaCodesForState = (stateName: string): string[] => {
  return Object.entries(AREA_CODE_TO_STATE)
    .filter(([_, state]) => state.toLowerCase() === stateName.toLowerCase())
    .map(([code]) => code);
};

export default {
  extractAreaCode,
  getStateFromAreaCode,
  getAreaCodesForState,
  AREA_CODE_TO_STATE,
};
