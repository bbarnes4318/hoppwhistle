root@hopwhistle-prod:~/hopwhistle# # Check all containers including stopped ones
docker ps -a | grep -E "hopwhistle-api|hopwhistle-worker"

# Check the logs of the most recent attempts
docker logs $(docker ps -a | grep hopwhistle-api | head -1 | awk '{print $1}') --tail 50
docker logs $(docker ps -a | grep hopwhistle-worker | head -1 | awk '{print $1}') --tail 50
docker: 'docker logs' requires 1 argument

Usage:  docker logs [OPTIONS] CONTAINER

Run 'docker logs --help' for more information
docker: 'docker logs' requires 1 argument

Usage:  docker logs [OPTIONS] CONTAINER

Run 'docker logs --help' for more information
root@hopwhistle-prod:~/hopwhistle# docker ps -a
CONTAINER ID   IMAGE                COMMAND                  CREATED        STATUS                            PORTS                                                                                                                                                                                                                                                                                           NAMES
c9925672f569   docker_kamailio      "/entrypoint.sh"         6 hours ago    Restarting (255) 46 seconds ago                                                                                                                                                                                                                                                                                                   hopwhistle-kamailio
76fb7d0b1e1e   daf4ce60dfe3         "/bin/sh -c 'pnpm ex…"   10 hours ago   Exited (1) 10 hours ago                                                                                                                                                                                                                                                                                                           bold_cray
4f5fe3b97a6c   dca92c2601c5         "/bin/sh -c 'pnpm ex…"   10 hours ago   Exited (1) 10 hours ago                                                                                                                                                                                                                                                                                                           frosty_ramanujan
a4b1cece3dda   fd7d3f078b80         "/bin/sh -c 'pnpm ex…"   10 hours ago   Exited (1) 10 hours ago                                                                                                                                                                                                                                                                                                           awesome_boyd
f4ee79518ccc   9a31dd75d7a0         "/bin/sh -c 'pnpm ex…"   14 hours ago   Exited (1) 14 hours ago                                                                                                                                                                                                                                                                                                           dazzling_mirzakhani
bda41278e6b3   24f3a1012537         "/bin/sh -c 'pnpm --…"   14 hours ago   Exited (1) 14 hours ago                                                                                                                                                                                                                                                                                                           nifty_goldstine
fa83bb530bed   8fa46ae842eb         "/bin/sh -c 'pnpm --…"   14 hours ago   Exited (1) 14 hours ago                                                                                                                                                                                                                                                                                                           flamboyant_shannon
52d827e8c828   995f110864f2         "/bin/sh -c 'pnpm ex…"   14 hours ago   Exited (1) 14 hours ago                                                                                                                                                                                                                                                                                                           ecstatic_snyder
750233ac663d   docker_freeswitch    "/docker-entrypoint.…"   18 hours ago   Up 18 hours (healthy)             0.0.0.0:5080->5080/tcp, [::]:5080->5080/tcp, 0.0.0.0:8021->8021/tcp, 0.0.0.0:5080->5080/udp, [::]:8021->8021/tcp, [::]:5080->5080/udp, 16384-32768/udp, 0.0.0.0:5062->5060/tcp, 0.0.0.0:5062->5060/udp, [::]:5062->5060/tcp, [::]:5062->5060/udp, 0.0.0.0:5063->5061/tcp, [::]:5063->5061/tcp   hopwhistle-freeswitch
8a0843b78cc5   docker_rtpengine     "/entrypoint.sh"         18 hours ago   Up 18 hours                       0.0.0.0:10000-10100->10000-10100/udp, [::]:10000-10100->10000-10100/udp, 22222/udp                                                                                                                                                                                                              hopwhistle-rtpengine
994959e145b7   docker_web           "docker-entrypoint.s…"   18 hours ago   Up 18 hours                       0.0.0.0:3000->3000/tcp, [::]:3000->3000/tcp                                                                                                                                                                                                                                                     hopwhistle-web
77b99460d10b   minio/minio:latest   "/usr/bin/docker-ent…"   18 hours ago   Up 18 hours (healthy)             0.0.0.0:9000-9001->9000-9001/tcp, [::]:9000-9001->9000-9001/tcp                                                                                                                                                                                                                                 docker_minio_1
2506bacde8d8   postgres:16-alpine   "docker-entrypoint.s…"   18 hours ago   Up 18 hours (healthy)             0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp                                                                                                                                                                                                                                                     docker_postgres_1
5a8cb608a480   redis:7-alpine       "docker-entrypoint.s…"   18 hours ago   Up 18 hours (healthy)             0.0.0.0:6379->6379/tcp, [::]:6379->6379/tcp                                                                                                                                                                                                                                                     docker_redis_1
8abb764d93eb   3388732efd02         "/bin/sh -c './node_…"   18 hours ago   Exited (1) 18 hours ago                                                                                                                                                                                                                                                                                                           pensive_chaum
root@hopwhistle-prod:~/hopwhistle# docker images | head -20
REPOSITORY                      TAG         IMAGE ID       CREATED          SIZE
<none>                          <none>      19293b32b86e   22 minutes ago   150MB
docker_api                      latest      6f77ac8cc125   22 minutes ago   1.13GB
<none>                          <none>      e24a8548c94d   23 minutes ago   1.52GB
<none>                          <none>      8c137361e07d   25 minutes ago   839MB
<none>                          <none>      000b4fda0b1c   5 hours ago      153MB
<none>                          <none>      ae01390eca7c   5 hours ago      1.31GB
<none>                          <none>      0c1d63668202   5 hours ago      1.5GB
<none>                          <none>      9fb653132121   5 hours ago      839MB
<none>                          <none>      d7c0f5c9b1bd   5 hours ago      1.43GB
<none>                          <none>      cbee47468729   5 hours ago      1.31GB
<none>                          <none>      a95e9d9657b1   5 hours ago      1.52GB
<none>                          <none>      ce8c3e89c833   5 hours ago      839MB
<none>                          <none>      02df342219d8   6 hours ago      1.52GB
<none>                          <none>      d184e8518209   6 hours ago      839MB
<none>                          <none>      f47b8a9b106f   6 hours ago      1.46GB
<none>                          <none>      86e0e1953fa4   6 hours ago      1.31GB
<none>                          <none>      d9bf2bc2fc34   6 hours ago      1.08GB
<none>                          <none>      9a78ad46c340   6 hours ago      1.46GB
<none>                          <none>      7223016d923a   6 hours ago      1.13GB
root@hopwhistle-prod:~/hopwhistle# docker images | grep docker_worker
root@hopwhistle-prod:~/hopwhistle# # Build worker
docker-compose --env-file .env \
  -f infra/docker/docker-compose.yml \
  -f infra/docker/docker-compose.prod.yml \
  -f infra/docker/docker-compose.voice.yml \
  build --no-cache worker

# Start API
docker run -d \
  --name hopwhistle-api \
  --network docker_default \
  --env-file .env \
  -p 3001:3001 \
  docker_api:latest

# Start worker (once build completes)
docker run -d \
  --name hopwhistle-worker \
  --network docker_default \
  --env-file .env \
  docker_worker:latest

# Check status
docker ps | grep hopwhistle

# Check logs
docker logs hopwhistle-api --tail 50
docker logs hopwhistle-worker --tail 50
Building worker
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon   4.33MB
Step 1/34 : FROM node:20-alpine AS base
 ---> 2b56f2779663
Step 2/34 : FROM base AS deps
 ---> 2b56f2779663
Step 3/34 : RUN apk add --no-cache libc6-compat
 ---> Running in 095aa1c4d7e6
fetch https://dl-cdn.alpinelinux.org/alpine/v3.22/main/x86_64/APKINDEX.tar.gz
fetch https://dl-cdn.alpinelinux.org/alpine/v3.22/community/x86_64/APKINDEX.tar.gz
(1/3) Installing musl-obstack (1.2.3-r2)
(2/3) Installing libucontext (1.3.2-r0)
(3/3) Installing gcompat (1.1.0-r4)
OK: 10 MiB in 21 packages
 ---> Removed intermediate container 095aa1c4d7e6
 ---> 20d3de73c583
Step 4/34 : WORKDIR /app
 ---> Running in aa68df3383c5
 ---> Removed intermediate container aa68df3383c5
 ---> 79b2923183e4
Step 5/34 : RUN corepack enable && corepack prepare pnpm@8.15.0 --activate
 ---> Running in c40327caed65
Preparing pnpm@8.15.0 for immediate activation...
 ---> Removed intermediate container c40327caed65
 ---> 7cf60e099d49
Step 6/34 : COPY package.json pnpm-lock.yaml* pnpm-workspace.yaml ./
 ---> ca3c65b81e5e
Step 7/34 : COPY apps/worker/package.json ./apps/worker/
 ---> 89b7ff5a2165
Step 8/34 : COPY packages/shared/package.json ./packages/shared/
 ---> 3a6293abd4e0
Step 9/34 : COPY packages/routing-dsl/package.json ./packages/routing-dsl/
 ---> 955ae1632616
Step 10/34 : COPY packages/sdk/package.json ./packages/sdk/
 ---> 382b09473e9b
Step 11/34 : RUN pnpm install --no-frozen-lockfile
 ---> Running in 49cf42926a8c
Scope: all 5 workspace projects

   ╭───────────────────────────────────────────────────────────────────╮
   │                                                                   │
   │                Update available! 8.15.0 → 10.23.0.                │
   │   Changelog: https://github.com/pnpm/pnpm/releases/tag/v10.23.0   │
   │     Run "corepack prepare pnpm@10.23.0 --activate" to update.     │
   │                                                                   │
   │      Follow @pnpmjs for updates: https://twitter.com/pnpmjs       │
   │                                                                   │
   ╰───────────────────────────────────────────────────────────────────╯

Progress: resolved 0, reused 0, downloaded 1, added 0
apps/worker                              |  WARN  deprecated @opentelemetry/exporter-jaeger@1.30.1
 WARN  deprecated eslint@8.57.1: This version is no longer supported. Please see https://eslint.org/version-support for other options.
apps/worker                              |  WARN  deprecated puppeteer@21.11.0
Progress: resolved 39, reused 0, downloaded 39, added 0
Progress: resolved 41, reused 0, downloaded 41, added 0
Progress: resolved 202, reused 0, downloaded 200, added 0
Progress: resolved 340, reused 0, downloaded 339, added 0
Progress: resolved 583, reused 0, downloaded 579, added 0
Progress: resolved 763, reused 0, downloaded 716, added 0
 WARN  7 deprecated subdependencies found: @humanwhocodes/config-array@0.13.0, @humanwhocodes/object-schema@2.0.3, @opentelemetry/otlp-proto-exporter-base@0.51.1, glob@7.2.3, inflight@1.0.6, rimraf@3.0.2, source-map@0.8.0-beta.0
Progress: resolved 917, reused 0, downloaded 849, added 0
Packages: +849
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Progress: resolved 917, reused 0, downloaded 849, added 849, done
.../node_modules/@prisma/engines postinstall$ node scripts/postinstall.js
.../node_modules/protobufjs postinstall$ node scripts/postinstall
.../node_modules/protobufjs postinstall: Done
.../node_modules/@prisma/engines postinstall: Done
.../esbuild@0.25.12/node_modules/esbuild postinstall$ node install.js
.../esbuild@0.21.5/node_modules/esbuild postinstall$ node install.js
.../node_modules/prisma preinstall$ node scripts/preinstall-entry.js
.../esbuild@0.25.12/node_modules/esbuild postinstall: Done
.../esbuild@0.21.5/node_modules/esbuild postinstall: Done
.../node_modules/prisma preinstall: Done
.../node_modules/@prisma/client postinstall$ node scripts/postinstall.js
.../node_modules/@prisma/client postinstall: prisma:warn We could not find your Prisma schema in the default locations (see: https://pris.ly/d/prisma-schema-location).
.../node_modules/@prisma/client postinstall: If you have a Prisma schema file in a custom path, you will need to run
.../node_modules/@prisma/client postinstall: `prisma generate --schema=./path/to/your/schema.prisma` to generate Prisma Client.
.../node_modules/@prisma/client postinstall: If you do not have a Prisma schema file yet, you can ignore this message.
.../node_modules/@prisma/client postinstall: Done
.../node_modules/puppeteer postinstall$ node install.mjs
.../node_modules/puppeteer postinstall: chrome-headless-shell (121.0.6167.85) downloaded to /root/.cache/puppeteer/chrome-headless-shell/linux-121.0.6167.85
.../node_modules/puppeteer postinstall: Chrome (121.0.6167.85) downloaded to /root/.cache/puppeteer/chrome/linux-121.0.6167.85
.../node_modules/puppeteer postinstall: Done
. prepare$ husky install
. prepare: husky - git command not found, skipping install
. prepare: Done

dependencies:
+ @prisma/client 6.19.0

devDependencies:
+ @commitlint/cli 18.6.1
+ @commitlint/config-conventional 18.6.3
+ @types/node 20.19.24
+ @typescript-eslint/eslint-plugin 6.21.0
+ @typescript-eslint/parser 6.21.0
+ eslint 8.57.1 deprecated
+ eslint-config-prettier 9.1.2
+ eslint-plugin-import 2.32.0
+ husky 8.0.3
+ lint-staged 15.5.2
+ prettier 3.6.2
+ prisma 6.19.0
+ typescript 5.9.3

 WARN  Issues with peer dependencies found
apps/worker
├─┬ @opentelemetry/exporter-prometheus 0.51.1
│ ├─┬ @opentelemetry/core 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ ├─┬ @opentelemetry/resources 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ └─┬ @opentelemetry/sdk-metrics 1.24.1
│   └── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
└─┬ @opentelemetry/sdk-node 0.51.1
  ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  ├─┬ @opentelemetry/exporter-trace-otlp-grpc 0.51.1
  │ └─┬ @opentelemetry/otlp-transformer 0.51.1
  │   ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  │   ├─┬ @opentelemetry/sdk-logs 0.51.1
  │   │ └── ✕ unmet peer @opentelemetry/api@">=1.4.0 <1.9.0": found 1.9.0
  │   └─┬ @opentelemetry/sdk-trace-base 1.24.1
  │     └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
  └─┬ @opentelemetry/sdk-trace-node 1.24.1
    ├── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/context-async-hooks 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/propagator-b3 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    └─┬ @opentelemetry/propagator-jaeger 1.24.1
      └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0

Done in 10m 32.7s
 ---> Removed intermediate container 49cf42926a8c
 ---> 2954db004a4d
Step 12/34 : FROM base AS builder
 ---> 2b56f2779663
Step 13/34 : WORKDIR /app
 ---> Running in 920c390a01d7
 ---> Removed intermediate container 920c390a01d7
 ---> fffafd5c0be2
Step 14/34 : RUN corepack enable && corepack prepare pnpm@8.15.0 --activate
 ---> Running in 05969cca696b
Preparing pnpm@8.15.0 for immediate activation...
 ---> Removed intermediate container 05969cca696b
 ---> 19effb9cac12
Step 15/34 : COPY . .
 ---> 8db9b7d216a8
Step 16/34 : RUN pnpm install --no-frozen-lockfile
 ---> Running in 053aeac96896
Scope: all 8 workspace projects
Progress: resolved 1, reused 0, downloaded 0, added 0
apps/api                                 |  WARN  deprecated supertest@6.3.4
apps/web                                 |  WARN  deprecated eslint@8.57.1
Progress: resolved 34, reused 0, downloaded 24, added 0
apps/api                                 |  WARN  deprecated @opentelemetry/exporter-jaeger@1.30.1
apps/api                                 |  WARN  deprecated puppeteer@21.11.0
apps/media                               |  WARN  deprecated fluent-ffmpeg@2.1.3

   ╭───────────────────────────────────────────────────────────────────╮
   │                                                                   │
   │                Update available! 8.15.0 → 10.23.0.                │
   │   Changelog: https://github.com/pnpm/pnpm/releases/tag/v10.23.0   │
   │     Run "corepack prepare pnpm@10.23.0 --activate" to update.     │
   │                                                                   │
   │      Follow @pnpmjs for updates: https://twitter.com/pnpmjs       │
   │                                                                   │
   ╰───────────────────────────────────────────────────────────────────╯

Progress: resolved 82, reused 0, downloaded 77, added 0
Progress: resolved 95, reused 0, downloaded 94, added 0
Progress: resolved 239, reused 0, downloaded 227, added 0
Progress: resolved 379, reused 0, downloaded 367, added 0
Progress: resolved 561, reused 0, downloaded 559, added 0
Progress: resolved 678, reused 0, downloaded 670, added 0
Progress: resolved 696, reused 0, downloaded 678, added 0
Progress: resolved 751, reused 0, downloaded 725, added 0
Progress: resolved 814, reused 0, downloaded 787, added 0
Progress: resolved 923, reused 0, downloaded 868, added 0
Progress: resolved 1044, reused 0, downloaded 988, added 0
Progress: resolved 1160, reused 0, downloaded 1037, added 0
Progress: resolved 1271, reused 0, downloaded 1150, added 0
Progress: resolved 1418, reused 0, downloaded 1322, added 0
 WARN  9 deprecated subdependencies found: @humanwhocodes/config-array@0.13.0, @humanwhocodes/object-schema@2.0.3, @opentelemetry/otlp-proto-exporter-base@0.51.1, glob@7.2.3, inflight@1.0.6, puppeteer@19.11.1, rimraf@3.0.2, source-map@0.8.0-beta.0, superagent@8.1.2
Progress: resolved 1478, reused 0, downloaded 1386, added 0

 WARN  Issues with peer dependencies found
apps/api
├─┬ @opentelemetry/exporter-prometheus 0.51.1
│ ├─┬ @opentelemetry/core 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ ├─┬ @opentelemetry/resources 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ └─┬ @opentelemetry/sdk-metrics 1.24.1
│   └── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
└─┬ @opentelemetry/sdk-node 0.51.1
  ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  ├─┬ @opentelemetry/exporter-trace-otlp-grpc 0.51.1
  │ └─┬ @opentelemetry/otlp-transformer 0.51.1
  │   ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  │   ├─┬ @opentelemetry/sdk-logs 0.51.1
  │   │ └── ✕ unmet peer @opentelemetry/api@">=1.4.0 <1.9.0": found 1.9.0
  │   └─┬ @opentelemetry/sdk-trace-base 1.24.1
  │     └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
  └─┬ @opentelemetry/sdk-trace-node 1.24.1
    ├── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/context-async-hooks 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/propagator-b3 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    └─┬ @opentelemetry/propagator-jaeger 1.24.1
      └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0

apps/worker
├─┬ @opentelemetry/exporter-prometheus 0.51.1
│ ├─┬ @opentelemetry/core 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ ├─┬ @opentelemetry/resources 1.24.1
│ │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
│ └─┬ @opentelemetry/sdk-metrics 1.24.1
│   └── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
└─┬ @opentelemetry/sdk-node 0.51.1
  ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  ├─┬ @opentelemetry/exporter-trace-otlp-grpc 0.51.1
  │ └─┬ @opentelemetry/otlp-transformer 0.51.1
  │   ├── ✕ unmet peer @opentelemetry/api@">=1.3.0 <1.9.0": found 1.9.0
  │   ├─┬ @opentelemetry/sdk-logs 0.51.1
  │   │ └── ✕ unmet peer @opentelemetry/api@">=1.4.0 <1.9.0": found 1.9.0
  │   └─┬ @opentelemetry/sdk-trace-base 1.24.1
  │     └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
  └─┬ @opentelemetry/sdk-trace-node 1.24.1
    ├── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/context-async-hooks 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    ├─┬ @opentelemetry/propagator-b3 1.24.1
    │ └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0
    └─┬ @opentelemetry/propagator-jaeger 1.24.1
      └── ✕ unmet peer @opentelemetry/api@">=1.0.0 <1.9.0": found 1.9.0

Packages: +1465
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Progress: resolved 1478, reused 0, downloaded 1386, added 451
Progress: resolved 1478, reused 0, downloaded 1386, added 1465
Progress: resolved 1478, reused 0, downloaded 1386, added 1465, done
node_modules/@prisma/engines postinstall$ node scripts/postinstall.js
node_modules/protobufjs postinstall$ node scripts/postinstall
node_modules/puppeteer postinstall$ node install.mjs
node_modules/protobufjs postinstall: Done
node_modules/puppeteer postinstall: **INFO** Skipping browser download as instructed.
node_modules/puppeteer postinstall: Done
node_modules/@prisma/engines postinstall: Done
node_modules/vite/node_modules/esbuild postinstall$ node install.js
node_modules/esbuild postinstall$ node install.js
node_modules/unrs-resolver postinstall$ napi-postinstall unrs-resolver 1.11.1 check
node_modules/prisma preinstall$ node scripts/preinstall-entry.js
node_modules/vite/node_modules/esbuild postinstall: Done
node_modules/unrs-resolver postinstall: Done
node_modules/esbuild postinstall: Done
node_modules/prisma preinstall: Done
node_modules/@prisma/client postinstall$ node scripts/postinstall.js
node_modules/@prisma/client postinstall: Environment variables loaded from .env
node_modules/@prisma/client postinstall: prisma:warn We could not find your Prisma schema in the default locations (see: https://pris.ly/d/prisma-schema-location).
node_modules/@prisma/client postinstall: If you have a Prisma schema file in a custom path, you will need to run
node_modules/@prisma/client postinstall: `prisma generate --schema=./path/to/your/schema.prisma` to generate Prisma Client.
node_modules/@prisma/client postinstall: If you do not have a Prisma schema file yet, you can ignore this message.
node_modules/@prisma/client postinstall: Done
.../mermaid-cli/node_modules/puppeteer postinstall$ node install.js
.../mermaid-cli/node_modules/puppeteer postinstall: **INFO** Skipping browser download as instructed.
.../mermaid-cli/node_modules/puppeteer postinstall: Done
. prepare$ husky install
. prepare: husky - git command not found, skipping install
. prepare: Done
Done in 32.5s
 ---> Removed intermediate container 053aeac96896
 ---> 19af44e075e6
Step 17/34 : RUN pnpm --filter @hopwhistle/shared exec tsup --no-dts
 ---> Running in 9594bc3f549f
CLI Building entry: src/index.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v8.5.0
CLI Using tsup config: /app/packages/shared/tsup.config.ts
CLI Target: es2022
CLI Cleaning output folder
ESM Build start
ESM dist/index.mjs     789.00 B
ESM dist/index.mjs.map 1.65 KB
ESM ⚡️ Build success in 24ms
 ---> Removed intermediate container 9594bc3f549f
 ---> 660aa581cc0c
Step 18/34 : RUN pnpm --filter @hopwhistle/routing-dsl exec tsup --no-dts
 ---> Running in f47b95408ded
CLI Building entry: src/index.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v8.5.0
CLI Using tsup config: /app/packages/routing-dsl/tsup.config.ts
CLI Target: es2022
CLI Cleaning output folder
ESM Build start

 WARN  ▲ [WARNING] Using direct eval with a bundler is not recommended and may cause problems [direct-eval]

    src/executor.ts:461:19:
      461 │     return Boolean(eval(evaluated));
          ╵                    ~~~~

  You can read more about direct eval and bundling here: https://esbuild.github.io/link/direct-eval



ESM dist/index.mjs     27.38 KB
ESM dist/index.mjs.map 53.72 KB
ESM ⚡️ Build success in 110ms
 ---> Removed intermediate container f47b95408ded
 ---> 2602e1840b77
Step 19/34 : RUN pnpm --filter @hopwhistle/sdk exec tsup --no-dts
 ---> Running in bddc772a1b48
CLI Building entry: src/index.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v8.5.0
CLI Using tsup config: /app/packages/sdk/tsup.config.ts
CLI Target: es2022
CLI Cleaning output folder
ESM Build start
ESM dist/index.mjs     7.67 KB
ESM dist/index.mjs.map 18.93 KB
ESM ⚡️ Build success in 26ms
 ---> Removed intermediate container bddc772a1b48
 ---> 981164075f5b
Step 20/34 : RUN rm -rf node_modules/@hopwhistle/shared &&     mkdir -p node_modules/@hopwhistle/shared &&     cp -r packages/shared/dist node_modules/@hopwhistle/shared/ &&     cp packages/shared/package.json node_modules/@hopwhistle/shared/
 ---> Running in 1b3802e744f4
 ---> Removed intermediate container 1b3802e744f4
 ---> 5ff8e68168fb
Step 21/34 : RUN rm -rf node_modules/@hopwhistle/routing-dsl &&     mkdir -p node_modules/@hopwhistle/routing-dsl &&     cp -r packages/routing-dsl/dist node_modules/@hopwhistle/routing-dsl/ &&     cp packages/routing-dsl/package.json node_modules/@hopwhistle/routing-dsl/
 ---> Running in 7f92501c463a
 ---> Removed intermediate container 7f92501c463a
 ---> 7ac50b5a6398
Step 22/34 : RUN rm -rf node_modules/@hopwhistle/sdk &&     mkdir -p node_modules/@hopwhistle/sdk &&     cp -r packages/sdk/dist node_modules/@hopwhistle/sdk/ &&     cp packages/sdk/package.json node_modules/@hopwhistle/sdk/
 ---> Running in 0eed11c27e49
 ---> Removed intermediate container 0eed11c27e49
 ---> d92b8ef81643
Step 23/34 : WORKDIR /app/apps/worker
 ---> Running in eab34bbb8e7c
 ---> Removed intermediate container eab34bbb8e7c
 ---> 1ee8320d729a
Step 24/34 : RUN pnpm build
 ---> Running in 6b2d40780545

> @hopwhistle/worker@0.1.0 build /app/apps/worker
> tsup

CLI Building entry: src/index.ts
CLI Using tsconfig: tsconfig.json
CLI tsup v8.5.0
CLI Using tsup config: /app/apps/worker/tsup.config.ts
CLI Target: es2022
CLI Cleaning output folder
ESM Build start
ESM dist/index.js     30.35 KB
ESM dist/index.js.map 57.38 KB
ESM ⚡️ Build success in 41ms
DTS Build start
DTS ⚡️ Build success in 4246ms
DTS dist/index.d.ts 13.00 B
 ---> Removed intermediate container 6b2d40780545
 ---> d9c9833cdaf7
Step 25/34 : FROM base AS runner
 ---> 2b56f2779663
Step 26/34 : WORKDIR /app
 ---> Running in ba56810e0986
 ---> Removed intermediate container ba56810e0986
 ---> 663d8d96df87
Step 27/34 : ENV NODE_ENV production
 ---> Running in 3b0252e1d2a3
 ---> Removed intermediate container 3b0252e1d2a3
 ---> 9458fc797b15
Step 28/34 : RUN addgroup --system --gid 1001 nodejs
 ---> Running in 6a038322e139
 ---> Removed intermediate container 6a038322e139
 ---> 2d76a06df383
Step 29/34 : RUN adduser --system --uid 1001 nextjs
 ---> Running in 6212fb14c6c9
 ---> Removed intermediate container 6212fb14c6c9
 ---> f4e3b43c9ac4
Step 30/34 : COPY --from=builder /app/apps/worker/dist ./dist
 ---> 807d73f2bd60
Step 31/34 : COPY --from=builder /app/node_modules ./node_modules
 ---> 8f6759da75de
Step 32/34 : COPY --from=builder /app/apps/worker/package.json ./package.json
 ---> 69c848a87568
Step 33/34 : USER nextjs
 ---> Running in 9c13446bf3b4
 ---> Removed intermediate container 9c13446bf3b4
 ---> d92536be0033
Step 34/34 : CMD ["node", "dist/index.js"]
 ---> Running in 2c81dd4bbc1e
 ---> Removed intermediate container 2c81dd4bbc1e
 ---> d547a40d2abe
Successfully built d547a40d2abe
Successfully tagged docker_worker:latest
48a5a73c058d83208916d99dc7afbdd7b1c9a372a6d2c731d848347006d45ad5
3a5f2641890fb5435f44a3e863013360701939f5b5b5bcb1ec737117f6a9da5f
3a5f2641890f   docker_worker:latest   "docker-entrypoint.s…"   1 second ago   Up Less than a second                                                                                                                                                                                                                                                                                                             hopwhistle-worker
48a5a73c058d   docker_api:latest      "docker-entrypoint.s…"   1 second ago   Up Less than a second             0.0.0.0:3001->3001/tcp, [::]:3001->3001/tcp                                                                                                                                                                                                                                                     hopwhistle-api
c9925672f569   docker_kamailio        "/entrypoint.sh"         6 hours ago    Restarting (255) 35 seconds ago                                                                                                                                                                                                                                                                                                   hopwhistle-kamailio
750233ac663d   docker_freeswitch      "/docker-entrypoint.…"   18 hours ago   Up 18 hours (healthy)             0.0.0.0:5080->5080/tcp, [::]:5080->5080/tcp, 0.0.0.0:8021->8021/tcp, 0.0.0.0:5080->5080/udp, [::]:8021->8021/tcp, [::]:5080->5080/udp, 16384-32768/udp, 0.0.0.0:5062->5060/tcp, 0.0.0.0:5062->5060/udp, [::]:5062->5060/tcp, [::]:5062->5060/udp, 0.0.0.0:5063->5061/tcp, [::]:5063->5061/tcp   hopwhistle-freeswitch
8a0843b78cc5   docker_rtpengine       "/entrypoint.sh"         18 hours ago   Up 18 hours                       0.0.0.0:10000-10100->10000-10100/udp, [::]:10000-10100->10000-10100/udp, 22222/udp                                                                                                                                                                                                              hopwhistle-rtpengine
994959e145b7   docker_web             "docker-entrypoint.s…"   18 hours ago   Up 18 hours                       0.0.0.0:3000->3000/tcp, [::]:3000->3000/tcp                                                                                                                                                                                                                                                     hopwhistle-web
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
root@hopwhistle-prod:~/hopwhistle# 

root@hopwhistle-prod:~/hopwhistle# docker logs hopwhistle-api --tail 50
docker logs hopwhistle-worker --tail 50
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
{"level":"info","time":"2025-11-23T13:56:07.280Z","service":"hopwhistle-api","version":"1.0.0","msg":"ClickHouse client initialized"}
[Tracing] Failed to initialize: TypeError: Resource is not a constructor
    at initTracing (file:///app/dist/index.js:17596:17)
    at buildServer (file:///app/dist/index.js:19144:3)
    at start (file:///app/dist/index.js:19261:26)
    at file:///app/dist/index.js:19278:1
    at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
{"level":"error","time":"2025-11-23T13:56:07.337Z","service":"hopwhistle-api","version":"1.0.0","msg":"Failed to start server","err":{"type":"Error","message":"Required secret JWT_SECRET is not set","stack":"Error: Required secret JWT_SECRET is not set\n    at _SecretsManager.getRequired (file:///app/dist/index.js:297:17)\n    at registerSession (file:///app/dist/index.js:12315:21)\n    at buildServer (file:///app/dist/index.js:19160:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async start (file:///app/dist/index.js:19261:20)"}}
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
{"level":"info","time":"2025-11-23T13:56:06.459Z","service":"hopwhistle-worker","version":"1.0.0","msg":"ClickHouse client initialized"}
/app/node_modules/.prisma/client/default.js:43
    throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.');
          ^

Error: @prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.
    at new PrismaClient (/app/node_modules/.prisma/client/default.js:43:11)
    at new ClickHouseETL (file:///app/dist/index.js:733:19)
    at file:///app/dist/index.js:914:21
    at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)

Node.js v20.19.5
root@hopwhistle-prod:~/hopwhistle# docker logs hopwhistle-api --tail 50
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
{"level":"info","time":"2025-11-23T13:56:07.280Z","service":"hopwhistle-api","version":"1.0.0","msg":"ClickHouse client initialized"}
[Tracing] Failed to initialize: TypeError: Resource is not a constructor
    at initTracing (file:///app/dist/index.js:17596:17)
    at buildServer (file:///app/dist/index.js:19144:3)
    at start (file:///app/dist/index.js:19261:26)
    at file:///app/dist/index.js:19278:1
    at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
{"level":"error","time":"2025-11-23T13:56:07.337Z","service":"hopwhistle-api","version":"1.0.0","msg":"Failed to start server","err":{"type":"Error","message":"Required secret JWT_SECRET is not set","stack":"Error: Required secret JWT_SECRET is not set\n    at _SecretsManager.getRequired (file:///app/dist/index.js:297:17)\n    at registerSession (file:///app/dist/index.js:12315:21)\n    at buildServer (file:///app/dist/index.js:19160:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async start (file:///app/dist/index.js:19261:20)"}}
root@hopwhistle-prod:~/hopwhistle# 

root@hopwhistle-prod:~/hopwhistle# docker logs hopwhistle-api --tail 50
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
{"level":"info","time":"2025-11-23T13:56:07.280Z","service":"hopwhistle-api","version":"1.0.0","msg":"ClickHouse client initialized"}
[Tracing] Failed to initialize: TypeError: Resource is not a constructor
    at initTracing (file:///app/dist/index.js:17596:17)
    at buildServer (file:///app/dist/index.js:19144:3)
    at start (file:///app/dist/index.js:19261:26)
    at file:///app/dist/index.js:19278:1
    at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)
{"level":"error","time":"2025-11-23T13:56:07.337Z","service":"hopwhistle-api","version":"1.0.0","msg":"Failed to start server","err":{"type":"Error","message":"Required secret JWT_SECRET is not set","stack":"Error: Required secret JWT_SECRET is not set\n    at _SecretsManager.getRequired (file:///app/dist/index.js:297:17)\n    at registerSession (file:///app/dist/index.js:12315:21)\n    at buildServer (file:///app/dist/index.js:19160:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async start (file:///app/dist/index.js:19261:20)"}}
root@hopwhistle-prod:~/hopwhistle# docker logs hopwhistle-worker --tail 50
[dotenv-flow@4.1.0]: ".env*" files loading failed: no ".env*" files matching pattern ".env[.production][.local]" in "/app" dir undefined
{"level":"info","time":"2025-11-23T13:56:06.459Z","service":"hopwhistle-worker","version":"1.0.0","msg":"ClickHouse client initialized"}
/app/node_modules/.prisma/client/default.js:43
    throw new Error('@prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.');
          ^

Error: @prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.
    at new PrismaClient (/app/node_modules/.prisma/client/default.js:43:11)
    at new ClickHouseETL (file:///app/dist/index.js:733:19)
    at file:///app/dist/index.js:914:21
    at ModuleJob.run (node:internal/modules/esm/module_job:325:25)
    at async ModuleLoader.import (node:internal/modules/esm/loader:606:24)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:117:5)

Node.js v20.19.5
root@hopwhistle-prod:~/hopwhistle# 